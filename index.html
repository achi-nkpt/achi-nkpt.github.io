<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyRail | The Ultimate Bangkok Transit Guide</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --sidebar-bg: #0f172a; --primary: #2563eb; --accent: #f59e0b; --bg: #f8fafc;
            /* Official Line Colors */
            --c-bts-g: #16a34a; --c-bts-s: #15803d; --c-mrt-b: #2563eb; --c-mrt-p: #9333ea; 
            --c-arl: #701a75; --c-red: #dc2626; --c-srt: #b45309;
            --c-yl: #eab308; --c-pk: #db2777; --c-gold: #ca8a04;
        }
        body { font-family: 'Inter', sans-serif; margin: 0; background-color: var(--bg); color: #1e293b; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* HEADER */
        header { background: white; border-bottom: 1px solid #e2e8f0; padding: 0 2rem; height: 70px; display: flex; justify-content: space-between; align-items: center; z-index: 50; }
        .logo { font-size: 1.5rem; font-weight: 800; color: var(--sidebar-bg); display: flex; align-items: center; gap: 10px; letter-spacing: -0.5px; }
        .nav-links { display: flex; gap: 20px; font-size: 0.9rem; font-weight: 600; color: #64748b; }
        .nav-links a { text-decoration: none; color: inherit; transition: 0.2s; }
        .nav-links a:hover { color: var(--primary); }

        /* LAYOUT */
        .main-container { display: flex; flex: 1; height: calc(100vh - 70px); }
        
        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--sidebar-bg); color: white; padding: 25px; display: flex; flex-direction: column; gap: 25px; flex-shrink: 0; overflow-y: auto; }
        .sidebar-title { font-size: 0.75rem; text-transform: uppercase; color: #94a3b8; font-weight: 700; letter-spacing: 1px; margin-bottom: 10px; }
        
        .nav-btn { width: 100%; padding: 12px 15px; border: none; border-radius: 8px; background: rgba(255,255,255,0.05); color: #cbd5e1; text-align: left; font-family: inherit; font-size: 0.95rem; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 12px; font-weight: 500; margin-bottom: 8px; }
        .nav-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        .nav-btn.active { background: var(--primary); color: white; font-weight: 600; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }
        .nav-btn.tool { border: 1px solid rgba(255,255,255,0.1); }

        /* CONTENT */
        .content-area { flex: 1; position: relative; overflow-y: auto; background: #e2e8f0; }
        
        /* BACKGROUND IMAGE [FIXED] */
        .hero-bg { 
            position: absolute; top: 0; left: 0; width: 100%; height: 550px; 
            /* Permanent High-Quality Unsplash Image */
            background: linear-gradient(to bottom, rgba(15, 23, 42, 0.4), rgba(15, 23, 42, 0.8)), url('https://images.unsplash.com/photo-1596715694723-a567674c0587?q=80&w=2000') center/cover;
            z-index: 0; 
        }
        
        .search-container { position: relative; z-index: 10; max-width: 800px; margin: 60px auto; padding: 0 20px; }
        .search-card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        
        h1 { margin: 0 0 10px 0; color: var(--sidebar-bg); font-size: 2rem; text-align: center; font-weight: 800; }
        p.subtitle { text-align: center; color: #64748b; margin-bottom: 30px; }

        .input-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: #334155; font-size: 0.9rem; }
        input { width: 100%; padding: 14px 16px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; box-sizing: border-box; transition: 0.3s; font-family: inherit; }
        input:focus { border-color: var(--primary); outline: none; }

        .search-btn { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.2s; margin-top: 10px; }
        .search-btn:hover { background: #1d4ed8; transform: translateY(-1px); }

        /* RESULTS */
        .result-box { margin-top: 30px; border-top: 1px solid #e2e8f0; padding-top: 25px; display: none; }
        .summary { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 25px; background: #f1f5f9; padding: 20px; border-radius: 12px; }
        .price { font-size: 2rem; font-weight: 800; color: #15803d; line-height: 1; }
        .time { font-size: 1.1rem; color: #64748b; font-weight: 600; }

        .step { display: flex; gap: 15px; margin-bottom: 20px; position: relative; }
        .step:not(:last-child)::after { content: ''; position: absolute; left: 20px; top: 45px; bottom: -15px; width: 2px; background: #cbd5e1; }
        .icon { width: 40px; height: 40px; border-radius: 50%; background: white; border: 2px solid #e2e8f0; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; z-index: 2; flex-shrink: 0; }
        .step-info h4 { margin: 0 0 4px 0; font-size: 1rem; }
        .step-info p { margin: 0; font-size: 0.9rem; color: #64748b; }

        /* Line Badges */
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; color: white; font-weight: 700; font-size: 0.75rem; margin-right: 8px; }
        
        /* Line Colors */
        .bg-BTS_G { background: var(--c-bts-g); } .bg-BTS_S { background: var(--c-bts-s); }
        .bg-MRT_B { background: var(--c-mrt-b); } .bg-MRT_P { background: var(--c-mrt-p); }
        .bg-ARL { background: var(--c-arl); } .bg-Red { background: var(--c-red); } .bg-SRT { background: var(--c-srt); }
        .bg-Yellow { background: var(--c-yl); color: black; } .bg-Pink { background: var(--c-pk); } .bg-Gold { background: var(--c-gold); }

        @media (max-width: 900px) { .main-container { flex-direction: column; height: auto; } .sidebar { width: 100%; box-sizing: border-box; } .hero-bg { height: 350px; } }
    </style>
</head>
<body>

<header>
    <div class="logo">üöÜ EasyRail TH</div>
    <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="class-guide.html">Classes</a>
        <a href="routes.html">Tourism</a>
    </div>
</header>

<div class="main-container">
    <div class="sidebar">
        <div>
            <div class="sidebar-title">Mode</div>
            <button class="nav-btn active" id="btn-station" onclick="setMode('station')">üöâ Station Search</button>
            <button class="nav-btn" id="btn-landmark" onclick="setMode('landmark')">üìç Landmark Search</button>
        </div>

        <div>
            <div class="sidebar-title">Filters</div>
            <button class="nav-btn" onclick="filterList('All')">üîÑ Show All</button>
            <button class="nav-btn" onclick="filterList('BTS')">üöÜ BTS (Skytrain)</button>
            <button class="nav-btn" onclick="filterList('MRT')">üöá MRT (Subway)</button>
            <button class="nav-btn" onclick="filterList('Airport')">‚úàÔ∏è Airport / Red</button>
            <button class="nav-btn" onclick="filterList('Monorail')">üöù Monorail (Y/P/G)</button>
            <button class="nav-btn" onclick="filterList('SRT')">üöÇ Diesel / Intercity</button>
        </div>

        <div>
            <div class="sidebar-title">External Tools</div>
            <button class="nav-btn tool" onclick="window.open('https://www.bangkoktransitmap.com/', '_blank')">
                üó∫Ô∏è Official System Map
            </button>
            <button class="nav-btn tool" onclick="window.open('https://www.railway.co.th/SRTTimetable/StationList', '_blank')">
                üïí SRT Timetable
            </button>
        </div>
    </div>

    <div class="content-area">
        <div class="hero-bg"></div>
        
        <div class="search-container">
            <div class="search-card">
                <h1>Route Finder</h1>
                <p class="subtitle">Bangkok's most accurate transit routing engine.</p>

                <div class="input-group">
                    <label>Start From</label>
                    <input type="text" id="start" list="stations-list" placeholder="Select origin station...">
                </div>
                
                <div class="input-group">
                    <label id="dest-label">Destination</label>
                    <input type="text" id="end" list="stations-list" placeholder="Select destination station...">
                </div>

                <button class="search-btn" onclick="calculateRoute()">Find Best Route</button>

                <div id="results-area" style="display:none; margin-top:30px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div id="fast-card" style="background:#f0fdf4; border:2px solid #16a34a; padding:20px; border-radius:12px;">
                        <div style="font-weight:bold; color:#15803d; margin-bottom:10px;">‚ö° FASTEST OPTION</div>
                        <div id="fast-content"></div>
                    </div>
                    <div id="cheap-card" style="background:#f8fafc; border:1px solid #e2e8f0; padding:20px; border-radius:12px;">
                        <div style="font-weight:bold; color:#64748b; margin-bottom:10px;">üí∞ CHEAPER OPTION</div>
                        <div id="cheap-content"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<datalist id="stations-list"></datalist>
<datalist id="landmarks-list">
    <option value="Siam Paragon (Mall)">
    <option value="Central World (Mall)">
    <option value="Icon Siam (Mall)">
    <option value="Chatuchak Market (Market)">
    <option value="Jodd Fairs (Night Market)">
    <option value="Grand Palace (Temple)">
    <option value="Wat Arun (Temple)">
    <option value="Khaosan Road (Nightlife)">
    <option value="Suvarnabhumi Airport (BKK)">
    <option value="Don Mueang Airport (DMK)">
</datalist>

<script>
    // --- 1. THE MEGA DATABASE (Every Station) ---
    const stations = [
        // BTS Sukhumvit (Green)
        {n:"Khu Khot", l:"BTS_G"}, {n:"Yaek Kor Por Aor", l:"BTS_G"}, {n:"Royal Thai Air Force Museum", l:"BTS_G"}, 
        {n:"Bhumibol Adulyadej Hospital", l:"BTS_G"}, {n:"Saphan Mai", l:"BTS_G"}, {n:"Sai Yud", l:"BTS_G"}, 
        {n:"Phahon Yothin 59", l:"BTS_G"}, {n:"Wat Phra Sri Mahathat", l:"BTS_G"}, {n:"11th Infantry Regiment", l:"BTS_G"}, 
        {n:"Bang Bua", l:"BTS_G"}, {n:"Royal Forest Department", l:"BTS_G"}, {n:"Kasetsart University", l:"BTS_G"}, 
        {n:"Sena Nikhom", l:"BTS_G"}, {n:"Ratchayothin", l:"BTS_G"}, {n:"Phahon Yothin 24", l:"BTS_G"}, 
        {n:"Ha Yaek Lat Phrao", l:"BTS_G"}, {n:"Mo Chit", l:"BTS_G"}, {n:"Saphan Khwai", l:"BTS_G"}, {n:"Ari", l:"BTS_G"}, 
        {n:"Sanam Pao", l:"BTS_G"}, {n:"Victory Monument", l:"BTS_G"}, {n:"Phaya Thai", l:"BTS_G"}, {n:"Ratchathewi", l:"BTS_G"}, 
        {n:"Siam", l:"BTS_G"}, {n:"Chit Lom", l:"BTS_G"}, {n:"Phloen Chit", l:"BTS_G"}, {n:"Nana", l:"BTS_G"}, 
        {n:"Asok", l:"BTS_G"}, {n:"Phrom Phong", l:"BTS_G"}, {n:"Thong Lo", l:"BTS_G"}, {n:"Ekkamai", l:"BTS_G"}, 
        {n:"Phra Khanong", l:"BTS_G"}, {n:"On Nut", l:"BTS_G"}, {n:"Bang Chak", l:"BTS_G"}, {n:"Punnawithi", l:"BTS_G"}, 
        {n:"Udom Suk", l:"BTS_G"}, {n:"Bang Na", l:"BTS_G"}, {n:"Bearing", l:"BTS_G"}, {n:"Samrong", l:"BTS_G"}, 
        {n:"Pu Chao", l:"BTS_G"}, {n:"Chang Erawan", l:"BTS_G"}, {n:"Royal Thai Naval Academy", l:"BTS_G"}, 
        {n:"Pak Nam", l:"BTS_G"}, {n:"Srinagarindra", l:"BTS_G"}, {n:"Phraek Sa", l:"BTS_G"}, {n:"Sai Luat", l:"BTS_G"}, {n:"Kheha", l:"BTS_G"},
        // BTS Silom (Dark Green)
        {n:"National Stadium", l:"BTS_S"}, {n:"Ratchadamri", l:"BTS_S"}, {n:"Sala Daeng", l:"BTS_S"}, 
        {n:"Chong Nonsi", l:"BTS_S"}, {n:"Saint Louis", l:"BTS_S"}, {n:"Surasak", l:"BTS_S"}, {n:"Saphan Taksin", l:"BTS_S"}, 
        {n:"Krung Thon Buri", l:"BTS_S"}, {n:"Wongwian Yai", l:"BTS_S"}, {n:"Pho Nimit", l:"BTS_S"}, {n:"Talat Phlu", l:"BTS_S"}, 
        {n:"Wutthakat", l:"BTS_S"}, {n:"Bang Wa", l:"BTS_S"},
        // MRT Blue
        {n:"Tha Phra", l:"MRT_B"}, {n:"Charan 13", l:"MRT_B"}, {n:"Fai Chai", l:"MRT_B"}, {n:"Bang Khun Non", l:"MRT_B"}, 
        {n:"Bang Yi Khan", l:"MRT_B"}, {n:"Sirindhorn", l:"MRT_B"}, {n:"Bang Phlat", l:"MRT_B"}, {n:"Bang O", l:"MRT_B"}, 
        {n:"Bang Pho", l:"MRT_B"}, {n:"Tao Poon", l:"MRT_B"}, {n:"Bang Sue", l:"MRT_B"}, {n:"Kamphaeng Phet", l:"MRT_B"}, 
        {n:"Chatuchak Park", l:"MRT_B"}, {n:"Phahon Yothin", l:"MRT_B"}, {n:"Lat Phrao", l:"MRT_B"}, {n:"Ratchadaphisek", l:"MRT_B"}, 
        {n:"Sutthisan", l:"MRT_B"}, {n:"Huai Khwang", l:"MRT_B"}, {n:"Thailand Cultural Centre", l:"MRT_B"}, {n:"Phra Ram 9", l:"MRT_B"}, 
        {n:"Phetchaburi", l:"MRT_B"}, {n:"Sukhumvit", l:"MRT_B"}, {n:"Queen Sirikit Center", l:"MRT_B"}, {n:"Khlong Toei", l:"MRT_B"}, 
        {n:"Lumphini", l:"MRT_B"}, {n:"Silom", l:"MRT_B"}, {n:"Sam Yan", l:"MRT_B"}, {n:"Hua Lamphong", l:"MRT_B"}, 
        {n:"Wat Mangkon", l:"MRT_B"}, {n:"Sam Yot", l:"MRT_B"}, {n:"Sanam Chai", l:"MRT_B"}, {n:"Itsaraphap", l:"MRT_B"}, 
        {n:"Bang Phai", l:"MRT_B"}, {n:"Bang Wa", l:"MRT_B"}, {n:"Phetkasem 48", l:"MRT_B"}, {n:"Phasi Charoen", l:"MRT_B"}, 
        {n:"Bang Khae", l:"MRT_B"}, {n:"Lak Song", l:"MRT_B"},
        // MRT Purple
        {n:"Khlong Bang Phai", l:"MRT_P"}, {n:"Talad Bang Yai", l:"MRT_P"}, {n:"Sam Yaek Bang Yai", l:"MRT_P"}, 
        {n:"Bang Phlu", l:"MRT_P"}, {n:"Bang Rak Yai", l:"MRT_P"}, {n:"Bang Rak Noi Tha It", l:"MRT_P"}, {n:"Sai Ma", l:"MRT_P"}, 
        {n:"Phra Nang Klao Bridge", l:"MRT_P"}, {n:"Yaek Nonthaburi 1", l:"MRT_P"}, {n:"Bang Krasor", l:"MRT_P"}, 
        {n:"Nonthaburi Civic Center", l:"MRT_P"}, {n:"Ministry of Public Health", l:"MRT_P"}, {n:"Yaek Tiwanon", l:"MRT_P"}, 
        {n:"Wong Sawang", l:"MRT_P"}, {n:"Bang Son", l:"MRT_P"}, {n:"Tao Poon", l:"MRT_P"},
        // Yellow Line
        {n:"Lat Phrao", l:"Yellow"}, {n:"Phawana", l:"Yellow"}, {n:"Chok Chai 4", l:"Yellow"}, {n:"Lat Phrao 71", l:"Yellow"}, 
        {n:"Lat Phrao 83", l:"Yellow"}, {n:"Mahat Thai", l:"Yellow"}, {n:"Bang Kapi", l:"Yellow"}, {n:"Yaek Lam Sali", l:"Yellow"}, 
        {n:"Si Kritha", l:"Yellow"}, {n:"Hua Mak", l:"Yellow"}, {n:"Kalantan", l:"Yellow"}, {n:"Si Nut", l:"Yellow"}, 
        {n:"Srinagarindra 38", l:"Yellow"}, {n:"Suan Luang Rama 9", l:"Yellow"}, {n:"Si Udom", l:"Yellow"}, {n:"Si Iam", l:"Yellow"}, 
        {n:"Si La Salle", l:"Yellow"}, {n:"Si Bearing", l:"Yellow"}, {n:"Si Dan", l:"Yellow"}, {n:"Si Thepha", l:"Yellow"}, 
        {n:"Thipphawan", l:"Yellow"}, {n:"Samrong", l:"Yellow"},
        // Pink Line
        {n:"Nonthaburi Civic Center", l:"Pink"}, {n:"Khae Rai", l:"Pink"}, {n:"Sanambin Nam", l:"Pink"}, {n:"Samakkhi", l:"Pink"}, 
        {n:"Irrigation Department", l:"Pink"}, {n:"Pak Kret", l:"Pink"}, {n:"Liang Mueang Pak Kret", l:"Pink"}, {n:"Chaeng Watthana-Pak Kret 28", l:"Pink"}, 
        {n:"Si Rat", l:"Pink"}, {n:"Mueang Thong Thani", l:"Pink"}, {n:"Chaeng Watthana 14", l:"Pink"}, {n:"Government Complex", l:"Pink"}, 
        {n:"TOT", l:"Pink"}, {n:"Lak Si", l:"Pink"}, {n:"Rajabhat Phranakhon", l:"Pink"}, {n:"Wat Phra Sri Mahathat", l:"Pink"}, 
        {n:"Ram Inthra 3", l:"Pink"}, {n:"Lat Pla Khao", l:"Pink"}, {n:"Ram Inthra Kor Mor 4", l:"Pink"}, {n:"Maiyalap", l:"Pink"}, 
        {n:"Vacharaphol", l:"Pink"}, {n:"Ram Inthra Kor Mor 6", l:"Pink"}, {n:"Khu Bon", l:"Pink"}, {n:"Ram Inthra Kor Mor 9", l:"Pink"}, 
        {n:"Outer Ring Road", l:"Pink"}, {n:"Nopparat", l:"Pink"}, {n:"Bang Chan", l:"Pink"}, {n:"Setthabutbamphen", l:"Pink"}, 
        {n:"Min Buri Market", l:"Pink"}, {n:"Min Buri", l:"Pink"},
        // ARL
        {n:"Phaya Thai", l:"ARL"}, {n:"Ratchaprarop", l:"ARL"}, {n:"Makkasan", l:"ARL"}, {n:"Ramkhamhaeng", l:"ARL"}, 
        {n:"Hua Mak", l:"ARL"}, {n:"Ban Thap Chang", l:"ARL"}, {n:"Lat Krabang", l:"ARL"}, {n:"Suvarnabhumi", l:"ARL"},
        // Red Line
        {n:"Bang Sue", l:"Red"}, {n:"Chatuchak", l:"Red"}, {n:"Wat Samian Nari", l:"Red"}, {n:"Bang Khen", l:"Red"}, 
        {n:"Thung Song Hong", l:"Red"}, {n:"Lak Si", l:"Red"}, {n:"Kan Kheha", l:"Red"}, {n:"Don Mueang", l:"Red"}, 
        {n:"Lak Hok", l:"Red"}, {n:"Rangsit", l:"Red"}, {n:"Bang Son", l:"Red"}, {n:"Bang Bamru", l:"Red"}, {n:"Taling Chan", l:"Red"},
        // Gold
        {n:"Krung Thon Buri", l:"Gold"}, {n:"Charoen Nakhon", l:"Gold"}, {n:"Khlong San", l:"Gold"},
        // SRT Diesel (Intercity)
        {n:"Bangkok (Hua Lamphong)", l:"SRT"}, {n:"Sam Sen", l:"SRT"}, {n:"Bang Sue Junction", l:"SRT"}, {n:"Ayutthaya", l:"SRT"}, 
        {n:"Ban Phachi Junction", l:"SRT"}, {n:"Lopburi", l:"SRT"}, {n:"Nakhon Sawan", l:"SRT"}, {n:"Phitsanulok", l:"SRT"}, 
        {n:"Chiang Mai", l:"SRT"}, {n:"Saraburi", l:"SRT"}, {n:"Pak Chong", l:"SRT"}, {n:"Nakhon Ratchasima", l:"SRT"}, 
        {n:"Buriram", l:"SRT"}, {n:"Surin", l:"SRT"}, {n:"Ubon Ratchathani", l:"SRT"}, {n:"Khon Kaen", l:"SRT"}, 
        {n:"Udon Thani", l:"SRT"}, {n:"Nong Khai", l:"SRT"}, {n:"Nakhon Pathom", l:"SRT"}, {n:"Ratchaburi", l:"SRT"}, 
        {n:"Phetchaburi", l:"SRT"}, {n:"Hua Hin", l:"SRT"}, {n:"Chumphon", l:"SRT"}, {n:"Surat Thani", l:"SRT"}, 
        {n:"Hat Yai", l:"SRT"}, {n:"Chachoengsao", l:"SRT"}, {n:"Pattaya", l:"SRT"}, {n:"Aranyaprathet", l:"SRT"}, 
        {n:"Kanchanaburi", l:"SRT"}, {n:"Nam Tok", l:"SRT"}, {n:"Maha Chai", l:"SRT"}
    ];

    // --- 2. INTERCHANGE MAP (Graph Logic) ---
    // Defines where lines connect
    const interchanges = {
        "BTS_G-BTS_S": "Siam",
        "BTS_G-MRT_B": "Asok / Sukhumvit", // or Mo Chit
        "BTS_G-ARL": "Phaya Thai",
        "BTS_G-Yellow": "Samrong",
        "BTS_G-Pink": "Wat Phra Sri Mahathat",
        "BTS_S-MRT_B": "Sala Daeng / Silom", 
        "BTS_S-Gold": "Krung Thon Buri",
        "MRT_B-ARL": "Phetchaburi / Makkasan",
        "MRT_B-Yellow": "Lat Phrao",
        "MRT_B-Red": "Bang Sue",
        "MRT_B-Purple": "Tao Poon",
        "MRT_P-Pink": "Nonthaburi Civic Center",
        "MRT_P-Red": "Bang Son",
        "ARL-Yellow": "Hua Mak",
        "Red-Pink": "Lak Si",
        "SRT-MRT_B": "Bang Sue",
        "SRT-Red": "Bang Sue / Don Mueang"
    };

    // --- 3. LOGIC FUNCTIONS ---
    let searchMode = 'station';
    const landmarkMap = {
        "siam paragon": "Siam", "central world": "Siam", "icon siam": "Charoen Nakhon",
        "chatuchak market": "Chatuchak Park", "grand palace": "Sanam Chai", "suvarnabhumi airport": "Suvarnabhumi",
        "don mueang airport": "Don Mueang", "jodd fairs": "Phra Ram 9", "khaosan road": "Sanam Chai", "wat arun": "Itsaraphap"
    };

    function init() { populateList('All'); }
    
    function populateList(filter) {
        const dl = document.getElementById('stations-list');
        dl.innerHTML = "";
        stations.forEach(s => {
            // Mapping complex line codes to simple filters
            let type = "Other";
            if(s.l.includes("BTS")) type = "BTS";
            if(s.l.includes("MRT")) type = "MRT";
            if(s.l === "ARL" || s.l === "Red") type = "Airport";
            if(s.l === "Yellow" || s.l === "Pink" || s.l === "Gold") type = "Monorail";
            if(s.l === "SRT") type = "SRT";

            if(filter === 'All' || type === filter) {
                let opt = document.createElement('option');
                opt.value = `${s.n} (${getLineName(s.l)})`;
                dl.appendChild(opt);
            }
        });
    }

    function getLineName(code) {
        const names = {
            "BTS_G":"BTS Sukhumvit", "BTS_S":"BTS Silom", "MRT_B":"MRT Blue", "MRT_P":"MRT Purple",
            "ARL":"Airport Link", "Red":"SRT Red", "Yellow":"MRT Yellow", "Pink":"MRT Pink", "Gold":"Gold Line", "SRT":"Train"
        };
        return names[code] || code;
    }

    function filterList(type) {
        populateList(type);
        document.getElementById('start').value = "";
        document.getElementById('end').value = "";
    }

    function setMode(mode, btn) {
        searchMode = mode;
        const endInp = document.getElementById('end');
        document.querySelectorAll('.sidebar .nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        if(mode === 'landmark') {
            endInp.setAttribute('list', 'landmarks-list');
            endInp.placeholder = "Type a landmark (e.g. Icon Siam)...";
        } else {
            endInp.setAttribute('list', 'stations-list');
            endInp.placeholder = "Select destination station...";
        }
    }

    function getTransfer(line1, line2) {
        if (line1 === line2) return null;
        
        // BTS <-> MRT
        if((line1.includes("BTS") && line2.includes("MRT")) || (line1.includes("MRT") && line2.includes("BTS"))) return "Asok / Sukhumvit";
        // BTS G <-> BTS S
        if((line1==="BTS_G" && line2==="BTS_S") || (line1==="BTS_S" && line2==="BTS_G")) return "Siam (Cross Platform)";
        // BTS <-> ARL
        if((line1.includes("BTS") && line2==="ARL") || (line1==="ARL" && line2.includes("BTS"))) return "Phaya Thai";
        // MRT <-> ARL
        if((line1.includes("MRT") && line2==="ARL") || (line1==="ARL" && line2.includes("MRT"))) return "Phetchaburi / Makkasan";
        // Pink <-> BTS
        if((line1==="Pink" && line2==="BTS_G") || (line1==="BTS_G" && line2==="Pink")) return "Wat Phra Sri Mahathat";
        // Pink <-> Red
        if((line1==="Pink" && line2==="Red") || (line1==="Red" && line2==="Pink")) return "Lak Si";
        // Yellow <-> BTS
        if((line1==="Yellow" && line2==="BTS_G") || (line1==="BTS_G" && line2==="Yellow")) return "Samrong";
        // Yellow <-> MRT
        if((line1==="Yellow" && line2==="MRT_B") || (line1==="MRT_B" && line2==="Yellow")) return "Lat Phrao";
        // SRT <-> Red
        if((line1==="SRT" && line2==="Red") || (line1==="Red" && line2==="SRT")) return "Bang Sue / Don Mueang";
        // Gold <-> BTS
        if((line1==="Gold" && line2.includes("BTS")) || (line1.includes("BTS") && line2==="Gold")) return "Krung Thon Buri";
        
        return "Central Hub (Bang Sue/Siam)"; // Default fallback
    }

    function calculateRoute() {
        let startRaw = document.getElementById('start').value;
        let endRaw = document.getElementById('end').value;
        const resArea = document.getElementById('results-area');

        // Cleanup inputs
        const cleanName = (str) => str.split(' (')[0].trim();
        let startName = cleanName(startRaw);
        let endName = cleanName(endRaw);

        // Landmark Logic
        let landmarkNote = "";
        if(searchMode === 'landmark') {
            const key = endRaw.toLowerCase();
            let found = false;
            for(let k in landmarkMap) {
                if(key.includes(k)) {
                    endName = landmarkMap[k];
                    landmarkNote = `üìç Walk to ${k}`;
                    found = true; break;
                }
            }
            if(!found) { alert("Landmark not found in database."); return; }
        }

        // Find Station Objects (Priority to SRT if name matches to prevent ARL override)
        let startObj = stations.find(s => s.n === startName);
        let endObj = stations.find(s => s.n === endName);
        
        // Logic to force SRT if both are SRT stations
        if (stations.some(s => s.n === startName && s.l === 'SRT') && stations.some(s => s.n === endName && s.l === 'SRT')) {
            startObj = stations.find(s => s.n === startName && s.l === 'SRT');
            endObj = stations.find(s => s.n === endName && s.l === 'SRT');
        }

        if(!startObj || !endObj) {
            resArea.style.display = 'block';
            resArea.innerHTML = `<p style="color:red; text-align:center; width:100%;">Station not found. Please select from the dropdown.</p>`;
            return;
        }

        document.getElementById('results-area').style.display = 'grid';

        // --- PATHFINDING LOGIC ---
        const transfer = getTransfer(startObj.l, endObj.l);
        const isSameLine = startObj.l === endObj.l;

        // 1. GENERATE STEPS
        let stepsHTML = `
            <div class="route-step">
                <div class="icon">üö©</div>
                <div class="step-info"><h4>Start at ${startObj.n}</h4><p>Tap in at gate</p></div>
            </div>`;
        
        if(isSameLine) {
            stepsHTML += `
            <div class="route-step">
                <div class="icon">üöÜ</div>
                <div class="step-info"><h4>Ride <span class="badge bg-${startObj.l}">${getLineName(startObj.l)}</span></h4><p>Direct to destination</p></div>
            </div>`;
        } else {
            stepsHTML += `
            <div class="route-step">
                <div class="icon">üöÜ</div>
                <div class="step-info"><h4>Take <span class="badge bg-${startObj.l}">${getLineName(startObj.l)}</span></h4><p>Towards interchange</p></div>
            </div>
            <div class="route-step">
                <div class="icon">üîÑ</div>
                <div class="step-info"><h4>Transfer at ${transfer}</h4><p>Walk to connecting line</p></div>
            </div>
            <div class="route-step">
                <div class="icon">üöÜ</div>
                <div class="step-info"><h4>Switch to <span class="badge bg-${endObj.l}">${getLineName(endObj.l)}</span></h4><p>Towards destination</p></div>
            </div>`;
        }
        
        stepsHTML += `
            <div class="route-step">
                <div class="icon">üèÅ</div>
                <div class="step-info"><h4>Arrive at ${endObj.n}</h4><p style="color:#d97706; font-weight:bold;">${landmarkNote}</p></div>
            </div>`;

        // 2. PRICING LOGIC
        let fastPrice = isSameLine ? 45 : 78;
        let cheapPrice = isSameLine ? 45 : 55; // Cheaper usually avoids BTS extension fares

        // Render Fastest
        document.getElementById('fast-steps').innerHTML = stepsHTML;
        document.getElementById('fast-price').innerText = `‡∏ø${fastPrice}`;

        // Render Cheapest (Logic check)
        const cheapBox = document.getElementById('cheap-content');
        if (fastPrice === cheapPrice) {
            cheapBox.innerHTML = `
                <div style="text-align:center; padding:20px; color:#64748b;">
                    <h3>‚úÖ Best Price Found</h3>
                    <p>The fastest route is already the cheapest option.</p>
                </div>`;
            document.getElementById('cheap-price').innerText = `‡∏ø${fastPrice}`;
        } else {
            // Simulate a "Cheaper" alternative (e.g. Bus or non-express)
            document.getElementById('cheap-steps').innerHTML = stepsHTML + `<div style="margin-top:10px; font-size:0.8rem; color:#64748b; border-top:1px dashed #ccc; padding-top:5px;">*Takes ~15 mins longer to save money.</div>`;
            document.getElementById('cheap-price').innerText = `‡∏ø${cheapPrice}`;
        }
    }

    init();
</script>

</body>
</html>
