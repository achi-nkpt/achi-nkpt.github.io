<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyRail | The Ultimate Bangkok Transit Guide</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --sidebar-bg: #0f172a; --primary: #2563eb; --accent: #f59e0b; --bg: #f8fafc;
            /* Official Line Colors */
            --c-bts-g: #16a34a; --c-bts-s: #15803d; --c-mrt-b: #2563eb; --c-mrt-p: #9333ea; 
            --c-arl: #701a75; --c-red: #dc2626; --c-srt: #b45309;
            --c-yl: #eab308; --c-pk: #db2777; --c-gold: #ca8a04;
        }
        body { font-family: 'Inter', sans-serif; margin: 0; background-color: var(--bg); color: #1e293b; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* HEADER */
        header { background: white; border-bottom: 1px solid #e2e8f0; padding: 0 2rem; height: 70px; display: flex; justify-content: space-between; align-items: center; z-index: 50; }
        .logo { font-size: 1.5rem; font-weight: 800; color: var(--sidebar-bg); display: flex; align-items: center; gap: 10px; letter-spacing: -0.5px; }
        .nav-links { display: flex; gap: 20px; font-size: 0.9rem; font-weight: 600; color: #64748b; }
        .nav-links a { text-decoration: none; color: inherit; transition: 0.2s; }
        .nav-links a:hover { color: var(--primary); }

        /* LAYOUT */
        .main-container { display: flex; flex: 1; height: calc(100vh - 70px); }
        
        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--sidebar-bg); color: white; padding: 25px; display: flex; flex-direction: column; gap: 25px; flex-shrink: 0; overflow-y: auto; }
        .sidebar-title { font-size: 0.75rem; text-transform: uppercase; color: #94a3b8; font-weight: 700; letter-spacing: 1px; margin-bottom: 10px; }
        
        .nav-btn { width: 100%; padding: 12px 15px; border: none; border-radius: 8px; background: rgba(255,255,255,0.05); color: #cbd5e1; text-align: left; font-family: inherit; font-size: 0.95rem; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 12px; font-weight: 500; margin-bottom: 8px; }
        .nav-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        .nav-btn.active { background: var(--primary); color: white; font-weight: 600; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }
        .nav-btn.tool { border: 1px solid rgba(255,255,255,0.1); }

        /* CONTENT */
        .content-area { flex: 1; position: relative; overflow-y: auto; background: #e2e8f0; }
        .hero-bg { 
            position: absolute; top: 0; left: 0; width: 100%; height: 550px; 
            background: linear-gradient(to bottom, rgba(15, 23, 42, 0.4), rgba(15, 23, 42, 0.8)), url('https://images.unsplash.com/photo-1582468574898-4a630800e330?q=80&w=2000') center/cover;
            z-index: 0; 
        }
        
        .search-container { position: relative; z-index: 10; max-width: 800px; margin: 60px auto; padding: 0 20px; }
        .search-card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        
        h1 { margin: 0 0 10px 0; color: var(--sidebar-bg); font-size: 2rem; text-align: center; font-weight: 800; }
        p.subtitle { text-align: center; color: #64748b; margin-bottom: 30px; }

        .input-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: #334155; font-size: 0.9rem; }
        input { width: 100%; padding: 14px 16px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; box-sizing: border-box; transition: 0.3s; font-family: inherit; }
        input:focus { border-color: var(--primary); outline: none; }

        .search-btn { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.2s; margin-top: 10px; }
        .search-btn:hover { background: #1d4ed8; transform: translateY(-1px); }

        /* RESULTS */
        .result-box { margin-top: 30px; border-top: 1px solid #e2e8f0; padding-top: 25px; display: none; }
        .summary { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 25px; background: #f1f5f9; padding: 20px; border-radius: 12px; }
        .price { font-size: 2rem; font-weight: 800; color: #15803d; line-height: 1; }
        .time { font-size: 1.1rem; color: #64748b; font-weight: 600; }

        .step { display: flex; gap: 15px; margin-bottom: 20px; position: relative; }
        .step:not(:last-child)::after { content: ''; position: absolute; left: 20px; top: 45px; bottom: -15px; width: 2px; background: #cbd5e1; }
        .icon { width: 40px; height: 40px; border-radius: 50%; background: white; border: 2px solid #e2e8f0; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; z-index: 2; flex-shrink: 0; }
        .step-info h4 { margin: 0 0 4px 0; font-size: 1rem; }
        .step-info p { margin: 0; font-size: 0.9rem; color: #64748b; }

        /* Line Badges */
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; color: white; font-weight: 700; font-size: 0.75rem; margin-right: 8px; }
        
        /* Line Colors */
        .bg-BTS_G { background: var(--c-bts-g); } .bg-BTS_S { background: var(--c-bts-s); }
        .bg-MRT_B { background: var(--c-mrt-b); } .bg-MRT_P { background: var(--c-mrt-p); }
        .bg-ARL { background: var(--c-arl); } .bg-Red { background: var(--c-red); } .bg-SRT { background: var(--c-srt); }
        .bg-Yellow { background: var(--c-yl); color: black; } .bg-Pink { background: var(--c-pk); } .bg-Gold { background: var(--c-gold); }

        @media (max-width: 900px) { .main-container { flex-direction: column; height: auto; } .sidebar { width: 100%; box-sizing: border-box; } .hero-bg { height: 350px; } }
    </style>
</head>
<body>

<header>
    <div class="logo">üöÜ EasyRail Thailand</div>
    <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="class-guide.html">Classes</a>
        <a href="routes.html">Tourism</a>
    </div>
</header>

<div class="main-container">
    <div class="sidebar">
        <div>
            <div class="sidebar-title">Mode</div>
            <button class="nav-btn active" id="btn-station" onclick="setMode('station')">üöâ Station Search</button>
            <button class="nav-btn" id="btn-landmark" onclick="setMode('landmark')">üìç Landmark Search</button>
        </div>

        <div>
            <div class="sidebar-title">Filters</div>
            <button class="nav-btn" onclick="filterList('All')">üîÑ Show All</button>
            <button class="nav-btn" onclick="filterList('BTS')">üöÜ BTS (Skytrain)</button>
            <button class="nav-btn" onclick="filterList('MRT')">üöá MRT (Subway)</button>
            <button class="nav-btn" onclick="filterList('Airport')">‚úàÔ∏è Airport / Red</button>
            <button class="nav-btn" onclick="filterList('Monorail')">üöù Monorail (Y/P/G)</button>
            <button class="nav-btn" onclick="filterList('SRT')">üöÇ Diesel / Intercity</button>
        </div>

        <div>
            <div class="sidebar-title">External Tools</div>
            <button class="nav-btn tool" onclick="window.open('https://www.bangkoktransitmap.com/', '_blank')">
                üó∫Ô∏è Official System Map
            </button>
            <button class="nav-btn tool" onclick="window.open('https://www.railway.co.th/SRTTimetable/StationList', '_blank')">
                üïí Check SRT Schedule
            </button>
        </div>
    </div>

    <div class="content-area">
        <div class="hero-bg"></div>
        
        <div class="search-container">
            <div class="search-card">
                <h1>Where do you want to go?</h1>
                <p class="subtitle">Bangkok's most accurate transit routing engine.</p>

                <div class="input-group">
                    <label>Start From</label>
                    <input type="text" id="start" list="stations-list" placeholder="Select origin station...">
                </div>
                
                <div class="input-group">
                    <label id="dest-label">Destination</label>
                    <input type="text" id="end" list="stations-list" placeholder="Select destination station...">
                </div>

                <button class="search-btn" onclick="calculateRoute()">Find Best Route</button>

                <div id="result" class="result-box"></div>
            </div>
        </div>
    </div>
</div>

<datalist id="stations-list"></datalist>
<datalist id="landmarks-list">
    <option value="Siam Paragon (Mall)">
    <option value="Central World (Mall)">
    <option value="Icon Siam (Mall)">
    <option value="Chatuchak Market (Market)">
    <option value="Jodd Fairs (Night Market)">
    <option value="Grand Palace (Temple)">
    <option value="Wat Arun (Temple)">
    <option value="Khaosan Road (Nightlife)">
    <option value="Suvarnabhumi Airport (BKK)">
    <option value="Don Mueang Airport (DMK)">
</datalist>

<script>
    // --- 1. THE MEGA DATABASE (Lines Mapped Correctly) ---
    const stations = [
        // BTS Sukhumvit (Green)
        {n:"Khu Khot", l:"BTS_G"}, {n:"Mo Chit", l:"BTS_G"}, {n:"Victory Monument", l:"BTS_G"}, {n:"Phaya Thai", l:"BTS_G"},
        {n:"Siam", l:"BTS_G"}, {n:"Asok", l:"BTS_G"}, {n:"Thong Lo", l:"BTS_G"}, {n:"Ekkamai", l:"BTS_G"}, {n:"On Nut", l:"BTS_G"},
        {n:"Bang Na", l:"BTS_G"}, {n:"Bearing", l:"BTS_G"}, {n:"Samrong", l:"BTS_G"}, {n:"Kheha", l:"BTS_G"}, {n:"Ha Yaek Lat Phrao", l:"BTS_G"},
        {n:"Wat Phra Sri Mahathat", l:"BTS_G"},
        // BTS Silom (Dark Green)
        {n:"National Stadium", l:"BTS_S"}, {n:"Sala Daeng", l:"BTS_S"}, {n:"Chong Nonsi", l:"BTS_S"}, {n:"Saphan Taksin", l:"BTS_S"},
        {n:"Krung Thon Buri", l:"BTS_S"}, {n:"Bang Wa", l:"BTS_S"},
        // MRT Blue
        {n:"Bang Sue", l:"MRT_B"}, {n:"Chatuchak Park", l:"MRT_B"}, {n:"Phahon Yothin", l:"MRT_B"}, {n:"Lat Phrao", l:"MRT_B"},
        {n:"Ratchadaphisek", l:"MRT_B"}, {n:"Sukhumvit", l:"MRT_B"}, {n:"Silom", l:"MRT_B"}, {n:"Hua Lamphong", l:"MRT_B"},
        {n:"Wat Mangkon", l:"MRT_B"}, {n:"Sanam Chai", l:"MRT_B"}, {n:"Itsaraphap", l:"MRT_B"}, {n:"Tao Poon", l:"MRT_B"},
        {n:"Phetchaburi", l:"MRT_B"}, {n:"Lak Song", l:"MRT_B"}, {n:"Tha Phra", l:"MRT_B"},
        // MRT Purple
        {n:"Tao Poon", l:"MRT_P"}, {n:"Bang Son", l:"MRT_P"}, {n:"Nonthaburi Civic Center", l:"MRT_P"}, {n:"Khlong Bang Phai", l:"MRT_P"},
        // Yellow Line
        {n:"Lat Phrao", l:"Yellow"}, {n:"Hua Mak", l:"Yellow"}, {n:"Suan Luang Rama 9", l:"Yellow"}, {n:"Samrong", l:"Yellow"},
        // Pink Line
        {n:"Nonthaburi Civic Center", l:"Pink"}, {n:"Lak Si", l:"Pink"}, {n:"Wat Phra Sri Mahathat", l:"Pink"}, {n:"Min Buri", l:"Pink"},
        // ARL
        {n:"Phaya Thai", l:"ARL"}, {n:"Ratchaprarop", l:"ARL"}, {n:"Makkasan", l:"ARL"}, {n:"Hua Mak", l:"ARL"}, {n:"Lat Krabang", l:"ARL"}, {n:"Suvarnabhumi", l:"ARL"},
        // Red Line
        {n:"Bang Sue", l:"Red"}, {n:"Chatuchak", l:"Red"}, {n:"Bang Khen", l:"Red"}, {n:"Lak Si", l:"Red"}, {n:"Don Mueang", l:"Red"}, {n:"Rangsit", l:"Red"}, {n:"Bang Son", l:"Red"},
        // Gold
        {n:"Krung Thon Buri", l:"Gold"}, {n:"Charoen Nakhon", l:"Gold"},
        // SRT Diesel
        {n:"Bangkok (Hua Lamphong)", l:"SRT"}, {n:"Bang Sue Junction", l:"SRT"}, {n:"Ayutthaya", l:"SRT"}, {n:"Lopburi", l:"SRT"},
        {n:"Chiang Mai", l:"SRT"}, {n:"Hua Hin", l:"SRT"}, {n:"Kanchanaburi", l:"SRT"}, {n:"Pattaya", l:"SRT"}, {n:"Surat Thani", l:"SRT"}, {n:"Lat Krabang", l:"SRT"}
    ];

    // --- 2. INTERCHANGE MAP (Graph Logic) ---
    // Defines where lines connect
    const interchanges = {
        "BTS_G-BTS_S": "Siam",
        "BTS_G-MRT_B": "Asok / Sukhumvit", // or Mo Chit
        "BTS_G-ARL": "Phaya Thai",
        "BTS_G-Yellow": "Samrong",
        "BTS_G-Pink": "Wat Phra Sri Mahathat",
        "BTS_S-MRT_B": "Sala Daeng / Silom", // or Bang Wa
        "BTS_S-Gold": "Krung Thon Buri",
        "MRT_B-ARL": "Phetchaburi / Makkasan",
        "MRT_B-Yellow": "Lat Phrao",
        "MRT_B-Red": "Bang Sue",
        "MRT_B-Purple": "Tao Poon",
        "MRT_P-Pink": "Nonthaburi Civic Center",
        "MRT_P-Red": "Bang Son",
        "ARL-Yellow": "Hua Mak",
        "Red-Pink": "Lak Si",
        "SRT-MRT_B": "Bang Sue",
        "SRT-Red": "Bang Sue / Don Mueang"
    };

    // --- 3. LOGIC FUNCTIONS ---
    let searchMode = 'station';
    const landmarkMap = {
        "siam paragon": "Siam", "central world": "Siam", "icon siam": "Charoen Nakhon",
        "chatuchak market": "Chatuchak Park", "grand palace": "Sanam Chai", "suvarnabhumi airport": "Suvarnabhumi",
        "don mueang airport": "Don Mueang", "jodd fairs": "Phra Ram 9", "khaosan road": "Sanam Chai", "wat arun": "Itsaraphap"
    };

    function init() { populateList('All'); }
    
    function populateList(filter) {
        const dl = document.getElementById('stations-list');
        dl.innerHTML = "";
        stations.forEach(s => {
            // Mapping complex line codes to simple filters
            let type = "Other";
            if(s.l.includes("BTS")) type = "BTS";
            if(s.l.includes("MRT")) type = "MRT";
            if(s.l === "ARL" || s.l === "Red") type = "Airport";
            if(s.l === "Yellow" || s.l === "Pink" || s.l === "Gold") type = "Monorail";
            if(s.l === "SRT") type = "SRT";

            if(filter === 'All' || type === filter) {
                let opt = document.createElement('option');
                opt.value = `${s.n} (${getLineName(s.l)})`;
                dl.appendChild(opt);
            }
        });
    }

    function getLineName(code) {
        const names = {
            "BTS_G":"BTS Sukhumvit", "BTS_S":"BTS Silom", "MRT_B":"MRT Blue", "MRT_P":"MRT Purple",
            "ARL":"Airport Link", "Red":"SRT Red", "Yellow":"MRT Yellow", "Pink":"MRT Pink", "Gold":"Gold Line", "SRT":"Train"
        };
        return names[code] || code;
    }

    function filterList(type) {
        populateList(type);
        document.getElementById('start').value = "";
        document.getElementById('end').value = "";
    }

    function setMode(mode) {
        searchMode = mode;
        const endInp = document.getElementById('end');
        document.getElementById('btn-station').className = mode === 'station' ? 'nav-btn active' : 'nav-btn';
        document.getElementById('btn-landmark').className = mode === 'landmark' ? 'nav-btn active' : 'nav-btn';
        
        if(mode === 'landmark') {
            endInp.setAttribute('list', 'landmarks-list');
            endInp.placeholder = "Type a landmark (e.g. Icon Siam)...";
        } else {
            endInp.setAttribute('list', 'stations-list');
            endInp.placeholder = "Select destination station...";
        }
    }

    function calculateRoute() {
        let startRaw = document.getElementById('start').value;
        let endRaw = document.getElementById('end').value;
        const resBox = document.getElementById('result');

        // Cleanup inputs to get just name
        const cleanName = (str) => str.split(' (')[0].trim();
        let startName = cleanName(startRaw);
        let endName = cleanName(endRaw);

        // Landmark Logic
        let landmarkNote = "";
        if(searchMode === 'landmark') {
            const key = endRaw.toLowerCase();
            let found = false;
            for(let k in landmarkMap) {
                if(key.includes(k)) {
                    endName = landmarkMap[k];
                    landmarkNote = `üìç Walk to ${key}`;
                    found = true; break;
                }
            }
            if(!found && searchMode === 'landmark') {
                alert("Landmark not found in database."); return;
            }
        }

        // Find Station Objects
        const startObj = stations.find(s => s.n === startName);
        const endObj = stations.find(s => s.n === endName);

        if(!startObj || !endObj) {
            resBox.style.display = 'block';
            resBox.innerHTML = `<p style="color:red; text-align:center">Station not found. Please select from the list.</p>`;
            return;
        }

        // --- PATHFINDING LOGIC ---
        let steps = [];
        let cost = 0;
        
        // Case 1: Same Line
        if (startObj.l === endObj.l) {
            steps.push({ icon:"üö©", text:`Start at <b>${startObj.n}</b>` });
            steps.push({ icon:"üöÜ", text:`Take <span class="badge bg-${startObj.l}">${getLineName(startObj.l)}</span> to <b>${endObj.n}</b>` });
            cost = 45; 
        } 
        // Case 2: Interchange Needed
        else {
            const key1 = `${startObj.l}-${endObj.l}`;
            const key2 = `${endObj.l}-${startObj.l}`;
            const directInter = interchanges[key1] || interchanges[key2];

            steps.push({ icon:"üö©", text:`Start at <b>${startObj.n}</b>` });
            steps.push({ icon:"üöÜ", text:`Take <span class="badge bg-${startObj.l}">${getLineName(startObj.l)}</span>` });

            if (directInter) {
                // Direct Connection
                steps.push({ icon:"üîÑ", text:`Interchange at <b>${directInter}</b>` });
                steps.push({ icon:"üöÜ", text:`Switch to <span class="badge bg-${endObj.l}">${getLineName(endObj.l)}</span>` });
                cost = 70;
            } else {
                // Indirect (Complex) - Simplified fallback for demo
                steps.push({ icon:"üîÑ", text:`Maps to <b>Central Hub (Siam/Asok)</b>` });
                steps.push({ icon:"üöÜ", text:`Switch lines to reach <b>${endObj.n}</b>` });
                cost = 90;
            }
        }

        steps.push({ icon:"üèÅ", text:`Arrive at <b>${endObj.n}</b> <br><small style="color:#d97706">${landmarkNote}</small>` });

        // Render
        resBox.style.display = 'block';
        resBox.innerHTML = `
            <div class="summary">
                <div><div class="price">‡∏ø${cost}</div><small>Estimated Fare</small></div>
                <div class="time">~${Math.floor(cost * 0.8)} mins</div>
            </div>
            ${steps.map(s => `
            <div class="step">
                <div class="icon">${s.icon}</div>
                <div class="step-info"><h4>${s.text}</h4></div>
            </div>`).join('')}
        `;
    }

    init();
</script>

</body>
</html>
