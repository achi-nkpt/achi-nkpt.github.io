<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyRail | Best Route Finder</title>
    <style>
        :root { 
            --primary: #003366; 
            --accent: #ff9900; 
            --bg: #f4f7f6;
            /* Line Colors */
            --bts-g: #76c043; /* Light Green */
            --bts-s: #006633; /* Dark Green */
            --mrt-b: #00236a; /* Blue */
            --mrt-p: #800080; /* Purple */
            --arl: #8e1f2f;   /* Airport Link */
            --red: #de1018;   /* Red Line */
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; color: #333; padding-bottom: 60px; }
        
        /* HEADER */
        header { background: var(--primary); color: white; padding: 1rem 5%; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .logo { font-size: 1.6rem; font-weight: 800; letter-spacing: -0.5px; }
        .nav-links { list-style: none; display: flex; gap: 20px; padding: 0; margin: 0; }
        .nav-links a { color: white; text-decoration: none; opacity: 0.9; font-weight: 500; }
        .nav-links a:hover { opacity: 1; text-decoration: underline; }

        /* SEARCH HERO */
        .hero-container { background: white; max-width: 600px; margin: 40px auto; padding: 30px; border-radius: 16px; box-shadow: 0 15px 40px rgba(0,0,0,0.08); }
        h1 { margin-top: 0; color: var(--primary); text-align: center; font-size: 1.8rem; }
        p.subtitle { text-align: center; color: #666; margin-bottom: 30px; }

        .input-group { position: relative; margin-bottom: 20px; }
        label { font-weight: 700; display: block; margin-bottom: 8px; color: #444; font-size: 0.9rem; }
        input { width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 16px; box-sizing: border-box; transition: 0.2s; }
        input:focus { border-color: var(--primary); outline: none; }

        .options { display: flex; gap: 10px; margin-bottom: 25px; justify-content: center; }
        .radio-label { cursor: pointer; display: flex; align-items: center; gap: 6px; background: #f5f5f5; padding: 10px 20px; border-radius: 30px; font-weight: 600; font-size: 0.9rem; transition: 0.2s; }
        .radio-label:hover { background: #e9e9e9; }
        input[type="radio"] { display: none; }
        input[type="radio"]:checked + span { color: var(--primary); }
        .radio-label.selected { background: #e6f0ff; border: 1px solid var(--primary); color: var(--primary); }

        button.search-btn { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 800; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 15px rgba(255, 153, 0, 0.3); }
        button.search-btn:hover { background: #e68a00; transform: translateY(-2px); }

        /* RESULTS */
        .result-card { background: white; max-width: 600px; margin: 20px auto; padding: 25px; border-radius: 12px; border-left: 6px solid var(--primary); box-shadow: 0 5px 20px rgba(0,0,0,0.05); display: none; animation: slideUp 0.4s ease; }
        
        .summary { display: flex; justify-content: space-between; align-items: center; padding-bottom: 15px; border-bottom: 1px solid #eee; margin-bottom: 20px; }
        .total-price { font-size: 1.8rem; font-weight: 800; color: #28a745; }
        .total-time { font-size: 1.1rem; color: #555; font-weight: 500; }
        
        .step { display: flex; gap: 18px; margin-bottom: 20px; position: relative; }
        .step:last-child { margin-bottom: 0; }
        /* Connecting Line */
        .step:not(:last-child)::after { content: ''; position: absolute; left: 19px; top: 40px; bottom: -20px; width: 2px; background: #eee; z-index: 0; }
        
        .step-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; background: #eee; z-index: 1; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); flex-shrink: 0; }
        .step-content { flex: 1; }
        .step-content h4 { margin: 0 0 4px 0; font-size: 1rem; }
        .step-content p { margin: 0; color: #777; font-size: 0.9rem; }
        
        /* Dynamic Line Colors */
        .line-BTS-Green { color: var(--bts-g); }
        .line-BTS-Silom { color: var(--bts-s); }
        .line-MRT-Blue { color: var(--mrt-b); }
        .line-MRT-Purple { color: var(--mrt-p); }
        .line-ARL { color: var(--arl); }
        .line-Red { color: var(--red); }
        .line-Walk { color: #888; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <div class="logo">ðŸš† EasyRail</div>
    <nav>
        <ul class="nav-links">
            <li><a href="index.html">Finder</a></li>
            <li><a href="class-guide.html">Classes</a></li>
            <li><a href="routes.html">Tourist Spots</a></li>
        </ul>
    </nav>
</header>

<div class="hero-container">
    <h1>Where do you want to go?</h1>
    <p class="subtitle">Search every line: BTS, MRT, ARL & Red Line.</p>
    
    <div class="input-group">
        <label>Start Station</label>
        <input type="text" id="start" list="stations" placeholder="e.g. Siam or Suvarnabhumi">
    </div>

    <div class="input-group">
        <label>Destination</label>
        <input type="text" id="end" list="stations" placeholder="e.g. Chatuchak or Don Mueang">
    </div>

    <div class="options">
        <label class="radio-label selected" onclick="selectRadio(this)">
            <input type="radio" name="mode" value="time" checked> <span>âš¡ Fastest</span>
        </label>
        <label class="radio-label" onclick="selectRadio(this)">
            <input type="radio" name="mode" value="price"> <span>ðŸ’° Cheapest</span>
        </label>
    </div>

    <button class="search-btn" onclick="findRoute()">Find Best Route</button>
</div>

<datalist id="stations">
    <option value="Siam (BTS)">
    <option value="Asok (BTS)">
    <option value="Mo Chit (BTS)">
    <option value="Phaya Thai (BTS)">
    <option value="Nana (BTS)">
    <option value="Thong Lo (BTS)">
    <option value="Victory Monument (BTS)">
    <option value="Sala Daeng (BTS)">
    <option value="Saphan Taksin (BTS)">
    <option value="Bang Wa (BTS)">
    <option value="Sukhumvit (MRT)">
    <option value="Chatuchak Park (MRT)">
    <option value="Silom (MRT)">
    <option value="Bang Sue (MRT)">
    <option value="Hua Lamphong (MRT)">
    <option value="Sanam Chai (MRT)">
    <option value="Phetchaburi (MRT)">
    <option value="Suvarnabhumi (ARL)">
    <option value="Makkasan (ARL)">
    <option value="Phaya Thai (ARL)">
    <option value="Don Mueang (Red)">
    <option value="Bang Sue (Red)">
</datalist>

<div id="result" class="result-card">
    <div class="summary">
        <div>
            <div class="total-price" id="res-price">à¸¿0</div>
            <div class="total-time" id="res-time">0 mins</div>
        </div>
        <div style="text-align: right;">
            <span style="background:#e6f0ff; color:var(--primary); padding:5px 10px; border-radius:4px; font-weight:bold; font-size:0.8rem;">BEST ROUTE</span>
        </div>
    </div>
    <div id="steps-container"></div>
</div>

<script>
    // --- 1. FULL NETWORK GRAPH (Main Interchanges & Tourist Spots) ---
    // Costs are approx standard fares. Times are average travel times.
    
    const network = {
        // --- CENTRAL INTERCHANGES ---
        "Siam (BTS)": {
            "Asok (BTS)": { cost: 30, time: 7, line: "BTS-Green", type: "ride" },
            "Phaya Thai (BTS)": { cost: 25, time: 5, line: "BTS-Green", type: "ride" },
            "Mo Chit (BTS)": { cost: 44, time: 12, line: "BTS-Green", type: "ride" },
            "Sala Daeng (BTS)": { cost: 25, time: 6, line: "BTS-Silom", type: "ride" } // Change platform
        },
        "Asok (BTS)": {
            "Siam (BTS)": { cost: 30, time: 7, line: "BTS-Green", type: "ride" },
            "Thong Lo (BTS)": { cost: 25, time: 4, line: "BTS-Green", type: "ride" },
            "Sukhumvit (MRT)": { cost: 0, time: 6, line: "Walk", type: "transfer" } // Interchange
        },
        "Sukhumvit (MRT)": {
            "Asok (BTS)": { cost: 0, time: 6, line: "Walk", type: "transfer" },
            "Phetchaburi (MRT)": { cost: 19, time: 3, line: "MRT-Blue", type: "ride" },
            "Silom (MRT)": { cost: 25, time: 8, line: "MRT-Blue", type: "ride" },
            "Chatuchak Park (MRT)": { cost: 35, time: 15, line: "MRT-Blue", type: "ride" }
        },
        
        // --- AIRPORT LINKS ---
        "Phaya Thai (BTS)": {
            "Siam (BTS)": { cost: 25, time: 5, line: "BTS-Green", type: "ride" },
            "Victory Monument (BTS)": { cost: 15, time: 3, line: "BTS-Green", type: "ride" },
            "Phaya Thai (ARL)": { cost: 0, time: 5, line: "Walk", type: "transfer" }
        },
        "Phaya Thai (ARL)": {
            "Phaya Thai (BTS)": { cost: 0, time: 5, line: "Walk", type: "transfer" },
            "Makkasan (ARL)": { cost: 25, time: 8, line: "ARL", type: "ride" },
            "Suvarnabhumi (ARL)": { cost: 45, time: 26, line: "ARL", type: "ride" }
        },
        "Makkasan (ARL)": {
            "Phaya Thai (ARL)": { cost: 25, time: 8, line: "ARL", type: "ride" },
            "Suvarnabhumi (ARL)": { cost: 35, time: 20, line: "ARL", type: "ride" },
            "Phetchaburi (MRT)": { cost: 0, time: 8, line: "Walk", type: "transfer" }
        },
        "Phetchaburi (MRT)": {
            "Makkasan (ARL)": { cost: 0, time: 8, line: "Walk", type: "transfer" },
            "Sukhumvit (MRT)": { cost: 19, time: 3, line: "MRT-Blue", type: "ride" },
            "Bang Sue (MRT)": { cost: 30, time: 15, line: "MRT-Blue", type: "ride" }
        },
        "Suvarnabhumi (ARL)": {
            "Makkasan (ARL)": { cost: 35, time: 20, line: "ARL", type: "ride" },
            "Phaya Thai (ARL)": { cost: 45, time: 26, line: "ARL", type: "ride" }
        },

        // --- NORTHERN HUB (Mo Chit / Chatuchak / Bang Sue) ---
        "Mo Chit (BTS)": {
            "Siam (BTS)": { cost: 44, time: 12, line: "BTS-Green", type: "ride" },
            "Chatuchak Park (MRT)": { cost: 0, time: 4, line: "Walk", type: "transfer" }
        },
        "Chatuchak Park (MRT)": {
            "Mo Chit (BTS)": { cost: 0, time: 4, line: "Walk", type: "transfer" },
            "Sukhumvit (MRT)": { cost: 35, time: 15, line: "MRT-Blue", type: "ride" },
            "Bang Sue (MRT)": { cost: 19, time: 5, line: "MRT-Blue", type: "ride" }
        },
        "Bang Sue (MRT)": {
            "Chatuchak Park (MRT)": { cost: 19, time: 5, line: "MRT-Blue", type: "ride" },
            "Bang Sue (Red)": { cost: 0, time: 6, line: "Walk", type: "transfer" } // Walk up to Red Line
        },
        "Bang Sue (Red)": {
            "Bang Sue (MRT)": { cost: 0, time: 6, line: "Walk", type: "transfer" },
            "Don Mueang (Red)": { cost: 35, time: 18, line: "Red", type: "ride" }
        },
        "Don Mueang (Red)": {
            "Bang Sue (Red)": { cost: 35, time: 18, line: "Red", type: "ride" }
        },

        // --- SILOM AREA ---
        "Sala Daeng (BTS)": {
            "Siam (BTS)": { cost: 25, time: 6, line: "BTS-Silom", type: "ride" },
            "Saphan Taksin (BTS)": { cost: 30, time: 8, line: "BTS-Silom", type: "ride" },
            "Silom (MRT)": { cost: 0, time: 8, line: "Walk", type: "transfer" } // Skywalk
        },
        "Silom (MRT)": {
            "Sala Daeng (BTS)": { cost: 0, time: 8, line: "Walk", type: "transfer" },
            "Sukhumvit (MRT)": { cost: 25, time: 8, line: "MRT-Blue", type: "ride" },
            "Hua Lamphong (MRT)": { cost: 19, time: 4, line: "MRT-Blue", type: "ride" },
            "Sanam Chai (MRT)": { cost: 25, time: 9, line: "MRT-Blue", type: "ride" }
        },
        "Hua Lamphong (MRT)": {
            "Silom (MRT)": { cost: 19, time: 4, line: "MRT-Blue", type: "ride" },
            "Sanam Chai (MRT)": { cost: 19, time: 5, line: "MRT-Blue", type: "ride" } // Palace
        },
        "Sanam Chai (MRT)": {
             "Silom (MRT)": { cost: 25, time: 9, line: "MRT-Blue", type: "ride" }
        },
        "Saphan Taksin (BTS)": {
            "Sala Daeng (BTS)": { cost: 30, time: 8, line: "BTS-Silom", type: "ride" }
        }
    };

    // --- 2. THE ALGORITHM (Dijkstra) ---
    function findRoute() {
        const start = document.getElementById('start').value;
        const end = document.getElementById('end').value;
        const mode = document.querySelector('input[name="mode"]:checked').value;
        
        if (!start || !end) { alert("Please enter both stations."); return; }
        if (start === end) { alert("You are already there!"); return; }
        if (!network[start] || !network[end]) {
            alert("Station not found in database! Try selecting from the dropdown list.");
            return;
        }

        const costs = {};
        const backtrace = {};
        const pq = new PriorityQueue();

        for (let node in network) costs[node] = Infinity;
        costs[start] = 0;
        pq.enqueue(start, 0);

        while (!pq.isEmpty()) {
            const shortestStep = pq.dequeue();
            const currentNode = shortestStep.element;
            if (currentNode === end) break; 

            for (let neighbor in network[currentNode]) {
                const edge = network[currentNode][neighbor];
                const weight = mode === 'time' ? edge.time : edge.cost;
                const newCost = costs[currentNode] + weight;

                if (newCost < costs[neighbor]) {
                    costs[neighbor] = newCost;
                    backtrace[neighbor] = { from: currentNode, details: edge };
                    pq.enqueue(neighbor, newCost);
                }
            }
        }

        // Reconstruct
        const path = [];
        let curr = end;
        while (curr !== start) {
            const step = backtrace[curr];
            if (!step) { alert("No route possible between these stations."); return; }
            path.unshift({ to: curr, ...step.details });
            curr = step.from;
        }

        displayResult(path);
    }

    // --- 3. UI HELPERS ---
    class PriorityQueue {
        constructor() { this.items = []; }
        enqueue(element, priority) {
            const qElement = { element, priority };
            let added = false;
            for (let i = 0; i < this.items.length; i++) {
                if (this.items[i].priority > qElement.priority) {
                    this.items.splice(i, 0, qElement);
                    added = true;
                    break;
                }
            }
            if (!added) this.items.push(qElement);
        }
        dequeue() { return this.items.shift(); }
        isEmpty() { return this.items.length === 0; }
    }

    function selectRadio(element) {
        document.querySelectorAll('.radio-label').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
        element.querySelector('input').checked = true;
    }

    function displayResult(path) {
        document.getElementById('result').style.display = 'block';
        const stepsDiv = document.getElementById('steps-container');
        stepsDiv.innerHTML = "";
        
        let totalPrice = 0;
        let totalTime = 0;

        path.forEach(step => {
            totalPrice += step.cost;
            totalTime += step.time;

            let icon = step.type === 'transfer' ? 'ðŸ‘£' : 'ðŸš†';
            let title = step.type === 'transfer' ? `Walk to ${step.to}` : `Take ${step.line} to ${step.to}`;
            let colorClass = `line-${step.line}`;
            
            // Nice formatting for "Walk"
            if (step.line === "Walk") colorClass = "line-Walk";

            stepsDiv.innerHTML += `
            <div class="step">
                <div class="step-icon">${icon}</div>
                <div class="step-content">
                    <h4 class="${colorClass}">${title}</h4>
                    <p>${step.time} mins â€¢ ${step.cost > 0 ? 'à¸¿'+step.cost : 'Free'}</p>
                </div>
            </div>`;
        });

        document.getElementById('res-price').innerText = `à¸¿${totalPrice}`;
        document.getElementById('res-time').innerText = `${totalTime} mins`;
        
        // Auto scroll to result
        document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
    }
</script>

</body>
</html>
